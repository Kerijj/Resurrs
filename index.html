<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ë–£–ù–ö–ï–†-–°–ò–ì–ù–ê–õ: –°–ò–°–¢–ï–ú–ê –ö–†–ê–§–¢–ê –ò –†–ï–°–£–†–°–û–í</title>
    <style>
        /* --- –û–°–ù–û–í–ù–´–ï –ù–ï–û–ù–û–í–´–ï –°–¢–ò–õ–ò --- */
        body {
            font-family: 'Consolas', 'Courier New', monospace;
            background-color: #0d0d0d;
            color: #00ff41; 
            margin: 0;
            padding: 20px;
            text-shadow: 0 0 5px #00ff41, 0 0 10px rgba(0, 255, 65, 0.5);
            line-height: 1.6;
        }
        h1, h2, h3, h4 {
            color: #00ffcc; 
            text-align: center;
            border-bottom: 2px solid #00ffcc;
            padding-bottom: 10px;
            margin-bottom: 20px;
            text-shadow: 0 0 8px #00ffcc, 0 0 15px rgba(0, 255, 204, 0.4);
        }
        #team-select, #game-container {
            max-width: 900px;
            margin: 0 auto;
            border: 2px solid #00ff41;
            padding: 30px;
            box-shadow: 0 0 20px #00ff41, 0 0 30px rgba(0, 255, 65, 0.3);
            background-color: rgba(0, 0, 0, 0.7);
        }
        
        /* --- –°–¢–ò–õ–ò –ö–ù–û–ü–û–ö --- */
        .btn, .choice-btn {
            background-color: transparent;
            color: #00ff41;
            border: 2px solid #00ff41;
            padding: 12px 25px;
            margin: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
            font-size: 1.1em;
            text-shadow: 0 0 5px #00ff41;
            box-shadow: 0 0 5px #00ff41 inset, 0 0 5px #00ff41;
            text-transform: uppercase;
        }
        .btn:hover, .choice-btn:hover:not(.disabled) {
            background-color: rgba(0, 255, 65, 0.2);
            color: #0d0d0d;
            border-color: #ffcc00; 
            box-shadow: 0 0 15px #ffcc00, 0 0 20px rgba(255, 204, 0, 0.5);
        }
        .btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .resource-transfer-btn {
            background-color: #ffcc00;
            color: #0d0d0d;
            border: 2px solid #ffcc00;
            padding: 8px 15px;
            margin-top: 15px;
            text-shadow: none;
        }

        /* --- –°–¢–ò–õ–ò –†–ï–°–£–†–°–û–í --- */
        .card-list {
            list-style: none;
            padding: 0;
        }
        .card-list li {
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 3px;
        }
        /* –ë–∞–∑–æ–≤—ã–µ —Ä–µ—Å—É—Ä—Å—ã (–°—ã—Ä—å–µ) */
        .res-base {
            background-color: #1a1a1a;
            border-left: 5px solid #00ffcc;
            color: #00ffcc;
        }
        /* –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã (–ö—Ä–∞—Ñ—Ç/–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã) */
        .res-crafted {
            background-color: #331a00;
            border-left: 5px solid #ffcc00;
            color: #ffcc00;
            font-weight: bold;
        }
        /* –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –ø–æ—Ç–µ—Ä–∏ */
        .warning {
            color: #ff004c;
            font-weight: bold;
        }
        .success {
            color: #00ff41;
            font-weight: bold;
        }
        .resource-status {
            color: #ffcc00;
            margin-top: 15px;
            border: 1px dashed #ffcc00;
            padding: 10px;
            text-align: center;
        }
        .craft-zone {
            margin-top: 20px;
            padding: 15px;
            border: 2px solid #00ffcc;
            background-color: rgba(0, 255, 204, 0.1);
            text-align: center;
        }
    </style>
</head>
<body>

    <div id="team-select">
        <h1>[ –°–ò–°–¢–ï–ú–ê –í–´–ñ–ò–í–ê–ù–ò–Ø –ë–£–ù–ö–ï–†–ê ]</h1>
        <h2>–ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –°–í–Ø–ó–ò</h2>
        <div style="text-align: center; margin-top: 40px;">
            <button class="btn" onclick="selectTeam('Group 1')">–ì–†–£–ü–ü–ê 1: –°–ï–ö–¶–ò–Ø –ê–õ–¨–§–ê</button>
            <button class="btn" onclick="selectTeam('Group 2')">–ì–†–£–ü–ü–ê 2: –°–ï–ö–¶–ò–Ø –ë–ï–¢–ê</button>
            <button class="btn" onclick="selectTeam('Group 3')">–ì–†–£–ü–ü–ê 3: –°–ï–ö–¶–ò–Ø –ì–ê–ú–ú–ê</button>
        </div>
    </div>

    <div id="game-container" style="display:none;">
        <h1>–ë–£–ù–ö–ï–†: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –†–ï–ñ–ò–ú</h1>
        <h2 id="team-display" style="color: #ffcc00;"></h2>

        <div id="timer-display">
            <span id="timer-label">–í–†–ï–ú–Ø –ù–ê –†–ê–£–ù–î</span>
            <span id="time-left">05:00</span>
        </div>
        
        <div id="round-nav" style="display: flex; justify-content: center; margin: 20px 0; flex-wrap: wrap;">
            <button class="round-btn active" data-round="1" onclick="showRound(1)">–†–ê–£–ù–î 1: –°–ë–û–† üå≤</button>
            <button class="round-btn" data-round="2" onclick="showRound(2)">–†–ê–£–ù–î 2: –ö–†–ê–§–¢ I üíß</button>
            <button class="round-btn" data-round="3" onclick="showRound(3)">–†–ê–£–ù–î 3: –ö–†–ê–§–¢ II üì°</button>
            <button class="round-btn" data-round="4" onclick="showRound(4)">–†–ê–£–ù–î 4: –†–ï–®–ï–ù–ò–ï üß≠</button>
            <button class="round-btn" data-round="5" onclick="showRound(5)">–†–ê–£–ù–î 5: –§–ò–ù–ê–õ ü§ù</button>
        </div>

        <div id="round-content">
            </div>
    </div>

    <script>
        // --- –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï –ò–ì–†–´ ---
        let currentTeam = null;
        let currentRound = 1;
        let timerInterval = null;

        // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∫–æ–º–∞–Ω–¥—ã
        let teamProgress = {
            "Group 1": { 
                resources: ["üíß –í–æ–¥–∞ (10–ª)", "üíä –ê–ø—Ç–µ—á–∫–∞", "üìù –°—Ö–µ–º–∞ (–§–∏–ª—å—Ç—Ä)"], // –°—Ç–∞—Ä—Ç–æ–≤—ã–µ —Ä–µ—Å—É—Ä—Å—ã
                crafted: [],
                lostResources: 0, 
                routeChosen: false,
                routeResult: null 
            },
            "Group 2": { 
                resources: ["üíß –í–æ–¥–∞ (10–ª)", "üîå –ü—Ä–æ–≤–æ–¥–∞", "üí° –õ–∞–º–ø–∞"], 
                crafted: [],
                lostResources: 0, 
                routeChosen: false,
                routeResult: null 
            },
            "Group 3": { 
                resources: ["üíß –í–æ–¥–∞ (10–ª)", "üî• –¢–æ–ø–ª–∏–≤–æ", "üó∫Ô∏è –ö–∞—Ä—Ç–∞"], 
                crafted: [],
                lostResources: 0, 
                routeChosen: false,
                routeResult: null 
            }
        };

        // --- –î–ê–ù–ù–´–ï –ò–ì–†–´ –° –ö–†–ê–§–¢–û–ú ---
        const gameData = {
            "Group 1": {
                name: "–ì–†–£–ü–ü–ê 1: –°–ï–ö–¶–ò–Ø –ê–õ–¨–§–ê",
                1: { // –°–ë–û–† –†–ï–°–£–†–°–û–í
                    objective: "–°–ë–û–† –†–ï–°–£–†–°–û–í. –õ–æ–∫–∞—Ü–∏—è: –ö—É—Ö–Ω—è. –¶–µ–ª—å: –ü–æ–ª—É—á–∏—Ç—å –¥–≤–∞ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ë–∞–∑–æ–≤—ã—Ö —Ä–µ—Å—É—Ä—Å–∞.",
                    choices: ["üî™ –ù–æ–∂", "üõ†Ô∏è –û—Ç–≤–µ—Ä—Ç–∫–∞", "üìö –£—á–µ–±–Ω–∏–∫"],
                    next_round_btn: "–ü–ï–†–ï–ô–¢–ò –ö –†–ê–£–ù–î–£ 2 (–ö–†–ê–§–¢ I)"
                },
                2: { // –ö–†–ê–§–¢ I: –§–ò–õ–¨–¢–† (–¢—Ä–µ–±—É–µ—Ç: üìù –°—Ö–µ–º–∞ (–§–∏–ª—å—Ç—Ä) –∏ üõ†Ô∏è –û—Ç–≤–µ—Ä—Ç–∫–∞)
                    objective: "–ö–†–ê–§–¢ –§–ò–õ–¨–¢–†–ê. –¶–µ–ª—å: –°–æ–±—Ä–∞—Ç—å **üíß –§–ò–õ–¨–¢–† –¥–ª—è –≤–æ–¥—ã** –∏–∑ —Å—ã—Ä—å—è.",
                    puzzle_text: "–ó–ê–ì–ê–î–ö–ê (–í–û–î–ê): –ß—Ç–æ –≤—Å–µ–≥–¥–∞ —Ç–µ—á–µ—Ç, –Ω–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–≤–∏–∂–µ—Ç—Å—è —Å –º–µ—Å—Ç–∞? (–û—Ç–≤–µ—Ç 4 –±—É–∫–≤—ã)",
                    answer: "–í–û–î–ê",
                    dependency: ["üìù –°—Ö–µ–º–∞ (–§–∏–ª—å—Ç—Ä)", "üõ†Ô∏è –û—Ç–≤–µ—Ä—Ç–∫–∞"],
                    crafted_item: "üíß –§–ò–õ–¨–¢–† –¥–ª—è –≤–æ–¥—ã",
                    next_round_btn: "–ü–ï–†–ï–ô–¢–ò –ö –†–ê–£–ù–î–£ 3 (–ö–†–ê–§–¢ II)"
                },
                3: { // –ö–†–ê–§–¢ II: –ê–ù–¢–ï–ù–ù–ê (–¢—Ä–µ–±—É–µ—Ç: üîå –ü—Ä–æ–≤–æ–¥–∞ –∏ üõ†Ô∏è –û—Ç–≤–µ—Ä—Ç–∫–∞)
                    objective: "–ö–†–ê–§–¢ –ê–ù–¢–ï–ù–ù–´. –¶–µ–ª—å: –°–æ–±—Ä–∞—Ç—å **üì° –ê–ù–¢–ï–ù–ù–ê** –¥–ª—è —Å–≤—è–∑–∏.",
                    puzzle_text: "–†–ï–ë–£–° (–°–í–Ø–ó–¨): –í–≤–µ–¥–∏—Ç–µ —Å–∏–Ω–æ–Ω–∏–º –∫ —Å–ª–æ–≤—É '–°–û–û–ë–©–ï–ù–ò–ï'. (–û—Ç–≤–µ—Ç 5 –±—É–∫–≤)",
                    answer: "–°–ò–ì–ù–ê–õ",
                    dependency: ["üîå –ü—Ä–æ–≤–æ–¥–∞", "üõ†Ô∏è –û—Ç–≤–µ—Ä—Ç–∫–∞"],
                    crafted_item: "üì° –ê–ù–¢–ï–ù–ù–ê",
                    next_round_btn: "–ü–ï–†–ï–ô–¢–ò –ö –†–ê–£–ù–î–£ 4 (–†–ï–®–ï–ù–ò–ï)"
                },
                4: { // –í–´–•–û–î –ù–ê –ü–û–í–ï–†–•–ù–û–°–¢–¨
                    objective: "–í–´–•–û–î –ù–ê –ü–û–í–ï–†–•–ù–û–°–¢–¨. –ê–Ω–∞–ª–∏–∑: –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –≤—ã—Ö–æ–¥—É.",
                    routes: [
                        { name: "–ú–ê–†–®–†–£–¢ –ê: –ö–æ—Ä–æ—Ç–∫–∏–π –∏ –û–ø–∞—Å–Ω—ã–π", risk: 2, reward: "–ë—ã—Å—Ç—Ä—ã–π –≤—ã—Ö–æ–¥", dependency: "üî™ –ù–æ–∂" },
                        { name: "–ú–ê–†–®–†–£–¢ –ë: –î–ª–∏–Ω–Ω—ã–π –∏ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π", risk: 0, reward: "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", dependency: "üó∫Ô∏è –ö–∞—Ä—Ç–∞" }
                    ],
                    next_round_btn: "–ü–ï–†–ï–ô–¢–ò –ö –§–ò–ù–ê–õ–£"
                },
                5: { objective: "–§–ò–ù–ê–õ: –°–¢–†–ê–¢–ï–ì–ò–Ø –°–ü–ê–°–ï–ù–ò–Ø", next_round_btn: "–ó–ê–í–ï–†–®–ò–¢–¨" }
            },
            "Group 2": {
                name: "–ì–†–£–ü–ü–ê 2: –°–ï–ö–¶–ò–Ø –ë–ï–¢–ê",
                1: { 
                    objective: "–°–ë–û–† –†–ï–°–£–†–°–û–í. –õ–æ–∫–∞—Ü–∏—è: –ú–∞—Å—Ç–µ—Ä—Å–∫–∞—è. –¶–µ–ª—å: –ü–æ–ª—É—á–∏—Ç—å –¥–≤–∞ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ë–∞–∑–æ–≤—ã—Ö —Ä–µ—Å—É—Ä—Å–∞.",
                    choices: ["üõ†Ô∏è –û—Ç–≤–µ—Ä—Ç–∫–∞", "üîã –ë–∞—Ç–∞—Ä–µ—è", "üìú –°—Ö–µ–º–∞ (–ê–Ω—Ç–µ–Ω–Ω–∞)"],
                    next_round_btn: "–ü–ï–†–ï–ô–¢–ò –ö –†–ê–£–ù–î–£ 2 (–ö–†–ê–§–¢ I)"
                },
                2: { 
                    objective: "–ö–†–ê–§–¢ –§–ò–õ–¨–¢–†–ê. –¶–µ–ª—å: –°–æ–±—Ä–∞—Ç—å **üíß –§–ò–õ–¨–¢–† –¥–ª—è –≤–æ–¥—ã** –∏–∑ —Å—ã—Ä—å—è.",
                    puzzle_text: "–ó–ê–î–ê–ß–ö–ê (–í–û–î–ê): –°–∫–æ–ª—å–∫–æ –ª–∏—Ç—Ä–æ–≤ –≤ –æ–¥–Ω–æ–º –∫—É–±–∏—á–µ—Å–∫–æ–º –º–µ—Ç—Ä–µ? (–û—Ç–≤–µ—Ç —Ü–∏—Ñ—Ä–∞–º–∏)",
                    answer: "1000",
                    dependency: ["üìù –°—Ö–µ–º–∞ (–§–∏–ª—å—Ç—Ä)", "üí° –õ–∞–º–ø–∞"],
                    crafted_item: "üíß –§–ò–õ–¨–¢–† –¥–ª—è –≤–æ–¥—ã",
                    next_round_btn: "–ü–ï–†–ï–ô–¢–ò –ö –†–ê–£–ù–î–£ 3 (–ö–†–ê–§–¢ II)"
                },
                3: { 
                    objective: "–ö–†–ê–§–¢ –°–ï–¢–ö–ò. –¶–µ–ª—å: –°–æ–±—Ä–∞—Ç—å **üé£ –°–ï–¢–ö–ê –¥–ª—è —Ä—ã–±—ã** (–¥–ª—è –ø—Ä–æ–ø–∏—Ç–∞–Ω–∏—è).",
                    puzzle_text: "–†–ï–ë–£–° (–ï–î–ê): –ù–∞–∑–æ–≤–∏—Ç–µ –∂–∏–≤–æ—Ç–Ω–æ–µ, –∫–æ—Ç–æ—Ä–æ–µ –¥–∞–µ—Ç —á–µ–ª–æ–≤–µ–∫—É –º–æ–ª–æ–∫–æ –∏ –º—è—Å–æ. (–û—Ç–≤–µ—Ç 4 –±—É–∫–≤—ã)",
                    answer: "–ö–û–ó–ê",
                    dependency: ["üîå –ü—Ä–æ–≤–æ–¥–∞", "üõ†Ô∏è –û—Ç–≤–µ—Ä—Ç–∫–∞"],
                    crafted_item: "üé£ –°–ï–¢–ö–ê –¥–ª—è —Ä—ã–±—ã",
                    next_round_btn: "–ü–ï–†–ï–ô–¢–ò –ö –†–ê–£–ù–î–£ 4 (–†–ï–®–ï–ù–ò–ï)"
                },
                4: { // –í–´–•–û–î –ù–ê –ü–û–í–ï–†–•–ù–û–°–¢–¨
                    objective: "–í–´–•–û–î –ù–ê –ü–û–í–ï–†–•–ù–û–°–¢–¨. –ê–Ω–∞–ª–∏–∑: –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –≤—ã—Ö–æ–¥—É.",
                    routes: [
                        { name: "–ú–ê–†–®–†–£–¢ –ë: –î–ª–∏–Ω–Ω—ã–π –∏ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π", risk: 0, reward: "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", dependency: "üé£ –°–ï–¢–ö–ê –¥–ª—è —Ä—ã–±—ã" },
                        { name: "–ú–ê–†–®–†–£–¢ –í: –°—Ä–µ–¥–Ω–∏–π, —Å –æ–±–≤–∞–ª–æ–º", risk: 1, reward: "–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π –≤—ã—Ö–æ–¥", dependency: "üîã –ë–∞—Ç–∞—Ä–µ—è" }
                    ],
                    next_round_btn: "–ü–ï–†–ï–ô–¢–ò –ö –§–ò–ù–ê–õ–£"
                },
                5: { objective: "–§–ò–ù–ê–õ: –°–¢–†–ê–¢–ï–ì–ò–Ø –°–ü–ê–°–ï–ù–ò–Ø", next_round_btn: "–ó–ê–í–ï–†–®–ò–¢–¨" }
            },
            "Group 3": {
                name: "–ì–†–£–ü–ü–ê 3: –°–ï–ö–¶–ò–Ø –ì–ê–ú–ú–ê",
                1: { 
                    objective: "–°–ë–û–† –†–ï–°–£–†–°–û–í. –õ–æ–∫–∞—Ü–∏—è: –°–∫–ª–∞–¥. –¶–µ–ª—å: –ü–æ–ª—É—á–∏—Ç—å –¥–≤–∞ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ë–∞–∑–æ–≤—ã—Ö —Ä–µ—Å—É—Ä—Å–∞.",
                    choices: ["üî™ –ù–æ–∂", "üõ†Ô∏è –û—Ç–≤–µ—Ä—Ç–∫–∞", "üé£ –õ–µ—Å–∫–∞"],
                    next_round_btn: "–ü–ï–†–ï–ô–¢–ò –ö –†–ê–£–ù–î–£ 2 (–ö–†–ê–§–¢ I)"
                },
                2: { 
                    objective: "–ö–†–ê–§–¢ –§–ò–õ–¨–¢–†–ê. –¶–µ–ª—å: –°–æ–±—Ä–∞—Ç—å **üíß –§–ò–õ–¨–¢–† –¥–ª—è –≤–æ–¥—ã** –∏–∑ —Å—ã—Ä—å—è.",
                    puzzle_text: "–ó–ê–ì–ê–î–ö–ê (–û–ì–û–ù–¨): '–Ø –Ω–µ –∂–∏–≤—É, –Ω–æ —Ä–∞—Å—Ç—É. –£ –º–µ–Ω—è –Ω–µ—Ç –ª–µ–≥–∫–∏—Ö, –Ω–æ –º–Ω–µ –Ω—É–∂–µ–Ω –≤–æ–∑–¥—É—Ö'. (–û—Ç–≤–µ—Ç 6 –±—É–∫–≤)",
                    answer: "–û–ì–û–ù–¨",
                    dependency: ["üìù –°—Ö–µ–º–∞ (–§–∏–ª—å—Ç—Ä)", "üî• –¢–æ–ø–ª–∏–≤–æ"],
                    crafted_item: "üíß –§–ò–õ–¨–¢–† –¥–ª—è –≤–æ–¥—ã",
                    next_round_btn: "–ü–ï–†–ï–ô–¢–ò –ö –†–ê–£–ù–î–£ 3 (–ö–†–ê–§–¢ II)"
                },
                3: { 
                    objective: "–ö–†–ê–§–¢ –°–ò–ì–ù–ê–õ–ò–ó–ê–¶–ò–ò. –¶–µ–ª—å: –°–æ–±—Ä–∞—Ç—å **üö® –°–ò–ì–ù–ê–õ–ò–ó–ê–¶–ò–Ø** (–¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –º–æ–Ω—Å—Ç—Ä–æ–≤).",
                    puzzle_text: "–†–ï–ë–£–° (–ó–ê–©–ò–¢–ê): –í–≤–µ–¥–∏—Ç–µ —Å–∏–Ω–æ–Ω–∏–º –∫ —Å–ª–æ–≤—É '–ó–ê–ü–ê–°'. (–û—Ç–≤–µ—Ç 7 –±—É–∫–≤)",
                    answer: "–†–ï–ó–ï–†–í",
                    dependency: ["üî• –¢–æ–ø–ª–∏–≤–æ", "üí° –õ–∞–º–ø–∞"],
                    crafted_item: "üö® –°–ò–ì–ù–ê–õ–ò–ó–ê–¶–ò–Ø",
                    next_round_btn: "–ü–ï–†–ï–ô–¢–ò –ö –†–ê–£–ù–î–£ 4 (–†–ï–®–ï–ù–ò–ï)"
                },
                4: { // –í–´–•–û–î –ù–ê –ü–û–í–ï–†–•–ù–û–°–¢–¨
                    objective: "–í–´–•–û–î –ù–ê –ü–û–í–ï–†–•–ù–û–°–¢–¨. –ê–Ω–∞–ª–∏–∑: –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –≤—ã—Ö–æ–¥—É.",
                    routes: [
                        { name: "–ú–ê–†–®–†–£–¢ –ê: –ö–æ—Ä–æ—Ç–∫–∏–π –∏ –û–ø–∞—Å–Ω—ã–π", risk: 2, reward: "–ë—ã—Å—Ç—Ä—ã–π –≤—ã—Ö–æ–¥", dependency: "üî™ –ù–æ–∂" },
                        { name: "–ú–ê–†–®–†–£–¢ –í: –°—Ä–µ–¥–Ω–∏–π, —Å –æ–±–≤–∞–ª–æ–º", risk: 1, reward: "–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π –≤—ã—Ö–æ–¥", dependency: "üö® –°–ò–ì–ù–ê–õ–ò–ó–ê–¶–ò–Ø" }
                    ],
                    next_round_btn: "–ü–ï–†–ï–ô–¢–ò –ö –§–ò–ù–ê–õ–£"
                },
                5: { objective: "–§–ò–ù–ê–õ: –°–¢–†–ê–¢–ï–ì–ò–Ø –°–ü–ê–°–ï–ù–ò–Ø", next_round_btn: "–ó–ê–í–ï–†–®–ò–¢–¨" }
            }
        };
        
        // --- –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –ü–†–û–í–ï–†–ö–ò –†–ï–°–£–†–°–û–í ---
        function hasResource(resourceName) {
            const progress = teamProgress[currentTeam];
            // –ò—â–µ–º —Ä–µ—Å—É—Ä—Å, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –ø—Ä–µ—Ñ–∏–∫—Å—ã –∏ —Å–º–∞–π–ª—ã –¥–ª—è –±–æ–ª–µ–µ –≥–∏–±–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞
            const searchName = resourceName.replace(/[\‚≠ê\s\w]+:\s?/g, '').trim(); 
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤ –ë–∞–∑–æ–≤—ã—Ö —Ä–µ—Å—É—Ä—Å–∞—Ö
            const inResources = progress.resources.some(res => res.includes(searchName));
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤ –°–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–∞—Ö
            const inCrafted = progress.crafted.some(res => res.includes(searchName));
            
            return inResources || inCrafted;
        }

        // --- –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò –ò–ì–†–´ ---

        function selectTeam(teamId) {
            currentTeam = teamId;
            document.getElementById('team-select').style.display = 'none';
            document.getElementById('game-container').style.display = 'block';
            document.getElementById('team-display').textContent = `[ –°–í–Ø–ó–¨ –£–°–¢–ê–ù–û–í–õ–ï–ù–ê: ${gameData[teamId].name} ]`;
            showRound(1); 
        }

        function startTimer(durationInSeconds) {
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            let timer = durationInSeconds;
            const display = document.getElementById('time-left');
            const timerDiv = document.getElementById('timer-display');
            
            timerInterval = setInterval(function () {
                let minutes = parseInt(timer / 60, 10);
                let seconds = parseInt(timer % 60, 10);
                minutes = minutes < 10 ? "0" + minutes : minutes;
                seconds = seconds < 10 ? "0" + seconds : seconds;
                display.textContent = minutes + ":" + seconds;

                if (--timer < 0) {
                    clearInterval(timerInterval);
                    display.textContent = "–í–†–ï–ú–Ø –ò–°–¢–ï–ö–õ–û! üíÄ";
                    timerDiv.style.color = '#ff004c'; 
                } else if (timer <= 60 && timer > 0) {
                     timerDiv.style.color = '#ffcc00'; 
                } else {
                     timerDiv.style.color = '#00ffcc';
                }
            }, 1000);
        }
        
        // --- –§–£–ù–ö–¶–ò–Ø –û–¢–û–ë–†–ê–ñ–ï–ù–ò–Ø –ö–û–ù–¢–ï–ù–¢–ê –†–ê–£–ù–î–ê ---
        function showRound(roundNum) {
            if (!currentTeam || !gameData[currentTeam]) return; 

            currentRound = roundNum; 
            
            const duration = (roundNum === 1 || roundNum === 4) ? 300 : 600;
            startTimer(duration); 

            document.querySelectorAll('.round-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.round-btn[data-round="${roundNum}"]`).classList.add('active');

            const data = gameData[currentTeam][roundNum];
            const progress = teamProgress[currentTeam];
            const contentDiv = document.getElementById('round-content');
            
            let html = `
                <h3 style="color:#ffcc00;">[ –¶–ï–õ–¨ –†–ê–£–ù–î–ê ${roundNum} ]</h3>
                
                <div class="round-objective">
                    ${data.objective}
                </div>
            `;
            let isBlocked = false;
            let blockMessage = '';
            
            // --- –†–ê–£–ù–î 1: –°–ë–û–† –†–ï–°–£–†–°–û–í ---
            if (roundNum === 1) {
                const initialResourceCount = 3; 
                
                html += '<h4 style="color:#00ffcc;">‚úÖ –í–´–ë–û–† –î–í–£–• –ë–ê–ó–û–í–´–• –†–ï–°–£–†–°–û–í:</h4>';
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ —Å–¥–µ–ª–∞–Ω –≤—ã–±–æ—Ä.
                if (progress.resources.length > initialResourceCount) { 
                    html += `<p class='success' style="text-align: center;">–ë–∞–∑–æ–≤—ã–µ —Ä–µ—Å—É—Ä—Å—ã —Å–æ–±—Ä–∞–Ω—ã (${progress.resources.slice(initialResourceCount).join(', ')}).</p>`;
                } else {
                    html += '<div style="text-align: center;">';
                    data.choices.forEach(choice => {
                        html += `<button class="choice-btn" onclick="selectResource('${choice}')">${choice}</button>`;
                    });
                    html += `</div>`;
                    // –ë–ª–æ–∫–∏—Ä—É–µ–º, –µ—Å–ª–∏ –Ω–µ –≤—ã–±—Ä–∞–Ω—ã 2 —Ä–µ—Å—É—Ä—Å–∞. 
                    if (progress.resources.length < initialResourceCount + 2) { 
                        isBlocked = true;
                        blockMessage = `*–í—ã–±–µ—Ä–∏—Ç–µ ${initialResourceCount + 2 - progress.resources.length} —Ä–µ—Å—É—Ä—Å(–∞).*`;
                    }
                }
            }

            // --- –†–ê–£–ù–î 2 & 3: –ö–†–ê–§–¢ (–°–æ–∑–¥–∞–Ω–∏–µ) ---
            if (roundNum === 2 || roundNum === 3) {
                const craftedItem = data.crafted_item;
                const isCrafted = progress.crafted.includes(craftedItem);
                const dependency1 = data.dependency[0];
                const dependency2 = data.dependency[1];
                
                html += `<h4 style="color:#ffcc00;">üîß –ó–û–ù–ê –ö–†–ê–§–¢–ê: –°–±–æ—Ä–∫–∞ ${craftedItem}</h4>`;
                
                if (isCrafted) {
                    html += `<p class='success' style="text-align: center;">‚úÖ **${craftedItem}** –°–û–ë–†–ê–ù.</p>`;
                } else {
                    const hasDep1 = hasResource(dependency1);
                    const hasDep2 = hasResource(dependency2);
                    
                    if (!hasDep1 || !hasDep2) {
                        isBlocked = true;
                        const missing = [];
                        if (!hasDep1) missing.push(dependency1);
                        if (!hasDep2) missing.push(dependency2);
                        
                        blockMessage = `‚ùå –ù–ï–î–û–°–¢–ê–Æ–©–ò–ï –†–ï–°–£–†–°–´: **${missing.join(' –∏ ')}**. –û–±—Å—É–¥–∏—Ç–µ —Å –¥—Ä—É–≥–∏–º–∏ –≥—Ä—É–ø–ø–∞–º–∏!`;
                        html += `<div class="resource-status warning">${blockMessage}</div>
                                <div style="text-align: center; margin-top: 15px;">
                                    <button class="btn" onclick="requestResource('${missing.join(', ')}', ${roundNum})">–ù–ê–†–ò–°–û–í–ê–¢–¨/–û–ë–°–£–î–ò–¢–¨ –°–î–ï–õ–ö–£</button>
                                </div>
                        `;
                    } else {
                         html += `
                            <p class='resource-status success'>‚úÖ –í–°–ï –†–ï–°–£–†–°–´ –ù–ê–ô–î–ï–ù–´: **${dependency1}** –∏ **${dependency2}**.</p>
                            <div class="craft-zone">
                                <strong>${data.puzzle_text}</strong>
                                <input type="text" id="puzzle-input" placeholder="–û—Ç–≤–µ—Ç" style="margin: 10px; padding: 8px;">
                                <button class="btn" onclick="craftItem(${roundNum}, '${data.answer}', '${craftedItem}', '${dependency1}', '${dependency2}')">–ü–†–û–í–ï–†–ò–¢–¨ –ò –ö–†–ê–§–¢–ò–¢–¨</button>
                                <p id="puzzle-feedback" style="margin-top: 10px;"></p>
                            </div>
                        `;
                        isBlocked = true; 
                    }
                }
            }
            
            // --- –†–ê–£–ù–î 4: –í–´–ë–û–† –ú–ê–†–®–†–£–¢–ê ---
            if (roundNum === 4) {
                const antenna = progress.crafted.includes("üì° –ê–ù–¢–ï–ù–ù–ê");
                const status = antenna ? 'üü¢ –ê–ù–¢–ï–ù–ù–ê –†–ê–ë–û–¢–ê–ï–¢' : 'üî¥ –ê–ù–¢–ï–ù–ù–ê –ù–ï–¢';
                
                if (progress.routeChosen) {
                     html += `<p class='success' style="text-align: center;">‚úÖ –†–ï–®–ï–ù–ò–ï –ü–†–ò–ù–Ø–¢–û: **${progress.routeResult}**</p>`;
                } else {
                    html += `<h4 style="color:#ffcc00;">üì° –°–¢–ê–¢–£–° –°–í–Ø–ó–ò: ${status}</h4>`;
                    html += '<h4 style="color:#00ffcc;">üó∫Ô∏è –í–´–ë–ï–†–ò–¢–ï –ú–ê–†–®–†–£–¢:</h4>';
                    html += '<div style="text-align: center;">';
                    
                    data.routes.forEach((route, index) => {
                         let routeStatus = hasResource(route.dependency) ? " (‚úîÔ∏è –ï–°–¢–¨ –ö–õ–Æ–ß)" : ` (‚ùå –ù–£–ñ–ï–ù: ${route.dependency})`;
                         let isRouteLocked = !hasResource(route.dependency);

                         html += `
                            <button class="choice-btn ${isRouteLocked ? 'disabled' : ''}" 
                                onclick="${isRouteLocked ? 'alert(\'–ú–∞—Ä—à—Ä—É—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω! –ù–µ—Ç –∫–ª—é—á–µ–≤–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞.\')' : `selectRoute('${route.name}', ${route.risk}, ${antenna})`}">
                                ${route.name} ${routeStatus}
                            </button>
                         `;
                    });
                    html += '</div>';
                    isBlocked = true; 
                }
            }


            // --- –ö–ê–†–¢–û–ß–ö–ò –ò –ö–ù–û–ü–ö–ê –ü–ï–†–ï–•–û–î–ê ---
            
            html += `
                <h4 style="color:#00ffcc; margin-top: 30px;">üì¶ –í–ê–® –ò–ù–í–ï–ù–¢–ê–†–¨:</h4>
                <ul class="card-list">
            `;
            // –ü–µ—Ä–µ—á–∏—Å–ª—è–µ–º –ë–∞–∑–æ–≤—ã–µ —Ä–µ—Å—É—Ä—Å—ã
            progress.resources.forEach((card) => {
                html += `<li class="res-base">${card}</li>`;
            });
            // –ü–µ—Ä–µ—á–∏—Å–ª—è–µ–º –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
            progress.crafted.forEach((card) => {
                html += `<li class="res-crafted">${card}</li>`;
            });
            
            // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ—Ç–µ—Ä—è—Ö
            if (progress.lostResources > 0) {
                 html += `<li><span class="warning">‚ùå –ü–û–¢–ï–†–Ø–ù–û: ${progress.lostResources} –µ–¥–∏–Ω–∏—Ü —Ä–µ—Å—É—Ä—Å–æ–≤ (–í–æ–¥–∞/–ï–¥–∞) –∏–∑-–∑–∞ –º–∞—Ä—à—Ä—É—Ç–∞.</span></li>`;
            }

            html += `</ul>`;

            // --- –ö–ù–û–ü–ö–ê –ü–ï–†–ï–î–ê–ß–ò –†–ï–°–£–†–°–ê ---
            html += `
                <div style="text-align: center; margin-top: 15px;">
                    <button class="btn resource-transfer-btn" onclick="transferResource()">
                        –ü–ï–†–ï–î–ê–¢–¨/–ü–û–õ–£–ß–ò–¢–¨ –†–ï–°–£–†–° (–ú–û–î–ï–†–ê–¢–û–†)
                    </button>
                </div>
            `;
            
            // –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞
            if (roundNum < 5) {
                if (isBlocked) {
                    if (blockMessage) html += `<p class="warning" style="text-align: center; margin-top: 15px;">${blockMessage}</p>`;
                } else {
                    html += `
                        <div style="text-align: center; margin-top: 30px;">
                            <button class="btn" onclick="nextRound()">
                                ${data.next_round_btn} (${roundNum + 1})
                            </button>
                        </div>
                    `;
                }
            } else {
                 html += `
                    <div style="text-align: center; margin-top: 30px;">
                         <p class="warning">–§–ò–ù–ê–õ! –ò–ì–†–ê –ó–ê–í–ï–†–®–ï–ù–ê. –£–¥–∞—á–∏ –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏!</p>
                    </div>
                `;
                 clearInterval(timerInterval);
            }
            
            contentDiv.innerHTML = html;
        }

        // --- –§–£–ù–ö–¶–ò–ò –ò–ù–¢–ï–†–ê–ö–¢–ò–í–ê ---

        // –†–ê–£–ù–î 1: –í—ã–±–æ—Ä —Ä–µ—Å—É—Ä—Å–∞
        function selectResource(choice) {
            const progress = teamProgress[currentTeam];
            const initialResourceCount = 3;
            
            if (progress.resources.length >= initialResourceCount + 2) return; 

            progress.resources.push(choice);
            alert(`‚úÖ –í—ã–±—Ä–∞–Ω: ${choice}. –í—ã–±–µ—Ä–∏—Ç–µ –µ—â–µ ${initialResourceCount + 2 - progress.resources.length} —Ä–µ—Å—É—Ä—Å(–∞).`);
            
            showRound(1); 
        }

        // –†–ê–£–ù–î 2 & 3: –ö–†–ê–§–¢ (–°–æ–∑–¥–∞–Ω–∏–µ)
        function craftItem(roundNum, correctAnswer, craftedItem, dep1, dep2) {
            const input = document.getElementById('puzzle-input');
            const feedback = document.getElementById('puzzle-feedback');
            const userInput = (input.value || '').trim().toUpperCase();
            const correct = correctAnswer.toUpperCase();
            const progress = teamProgress[currentTeam];

            if (userInput === correct) {
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –µ—â–µ —Ä–∞–∑ –ø–µ—Ä–µ–¥ –∫—Ä–∞—Ñ—Ç–æ–º
                if (!hasResource(dep1) || !hasResource(dep2)) {
                    feedback.innerHTML = '<span class="warning">‚ùå –û–®–ò–ë–ö–ê –ö–†–ê–§–¢–ê. –†–µ—Å—É—Ä—Å—ã –∏—Å—á–µ–∑–ª–∏? –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å!</span>';
                    return;
                }

                // 1. –£—Å–ø–µ—à–Ω—ã–π –∫—Ä–∞—Ñ—Ç: –¥–æ–±–∞–≤–ª—è–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç
                progress.crafted.push(craftedItem);
                
                // 2. –£–¥–∞–ª—è–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –±–∞–∑–æ–≤—ã–µ —Ä–µ—Å—É—Ä—Å—ã (—É–¥–∞–ª—è–µ–º –ø–µ—Ä–≤–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ)
                const dep1Index = progress.resources.findIndex(res => res.includes(dep1.replace(/[\‚≠ê\s\w]+:\s?/g, '').trim()));
                if (dep1Index > -1) progress.resources.splice(dep1Index, 1);
                
                const dep2Index = progress.resources.findIndex(res => res.includes(dep2.replace(/[\‚≠ê\s\w]+:\s?/g, '').trim()));
                if (dep2Index > -1) progress.resources.splice(dep2Index, 1);

                
                clearInterval(timerInterval);
                feedback.innerHTML = `<span class="success">‚úÖ –ö–û–î –ü–†–ò–ù–Ø–¢. **${craftedItem}** –£–°–ü–ï–®–ù–û –°–û–ó–î–ê–ù.</span>`;
                alert(`–£–°–ü–ï–•! ${craftedItem} —Å–æ–∑–¥–∞–Ω. –†–µ—Å—É—Ä—Å—ã ${dep1} –∏ ${dep2} –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã.`);

                showRound(roundNum); 
            } else {
                feedback.innerHTML = '<span class="warning">‚ùå –û–®–ò–ë–ö–ê –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –≤–≤–æ–¥.</span>';
                input.value = ''; 
            }
        }
        
        // --- –†–ê–£–ù–î 4 - –í—ã–±–æ—Ä –º–∞—Ä—à—Ä—É—Ç–∞ ---
        function selectRoute(routeName, baseRisk, hasAntenna) {
            const progress = teamProgress[currentTeam];
            if (progress.routeChosen) return;

            let finalRisk = baseRisk;
            let resultMessage = `–í—ã –≤—ã–±—Ä–∞–ª–∏ **${routeName}**.`;

            // –í–ª–∏—è–Ω–∏–µ –ê–Ω—Ç–µ–Ω–Ω—ã –Ω–∞ —Ä–∏—Å–∫
            if (!hasAntenna && baseRisk > 0) {
                // –ï—Å–ª–∏ –Ω–µ—Ç –ê–Ω—Ç–µ–Ω–Ω—ã, —Ä–∏—Å–∫ –æ–ø–∞—Å–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞ —É–¥–≤–∞–∏–≤–∞–µ—Ç—Å—è
                finalRisk += baseRisk; 
                resultMessage += " **(‚ö†Ô∏è –ù–ï–¢ –ê–ù–¢–ï–ù–ù–´: –†–∏—Å–∫ —É–¥–≤–æ–µ–Ω!)**";
            } else if (hasAntenna && baseRisk > 0) {
                // –ï—Å–ª–∏ –ê–Ω—Ç–µ–Ω–Ω–∞ –µ—Å—Ç—å, —Ä–∏—Å–∫ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è
                finalRisk = Math.max(0, finalRisk - 1);
                resultMessage += " **(üì° –ê–ù–¢–ï–ù–ù–ê: –†–∏—Å–∫ —Å–Ω–∏–∂–µ–Ω!)**";
            }
            
            if (finalRisk > 0) {
                const lostCount = Math.floor(Math.random() * (finalRisk + 1)); 
                progress.lostResources = lostCount;
                
                if (lostCount > 0) {
                    resultMessage += ` –í –ø—É—Ç–∏ –∏–∑-–∑–∞ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏/–ø–æ–º–µ—Ö –≤—ã **–ø–æ—Ç–µ—Ä—è–ª–∏ ${lostCount} –µ–¥–∏–Ω–∏—Ü** —Ä–µ—Å—É—Ä—Å–æ–≤ (–í–æ–¥–∞/–ï–¥–∞).`;
                } else {
                    resultMessage += " –í—ã –ø—Ä–æ—à–ª–∏ **–±–µ–∑ –ø–æ—Ç–µ—Ä—å**, –Ω–æ —Ä–∏—Å–∫ –±—ã–ª –≤—ã—Å–æ–∫.";
                }
            } else {
                resultMessage += " –ú–∞—Ä—à—Ä—É—Ç –æ–∫–∞–∑–∞–ª—Å—è **–ø–æ–ª–Ω–æ—Å—Ç—å—é –±–µ–∑–æ–ø–∞—Å–Ω—ã–º**, –ø–æ—Ç–µ—Ä—å –Ω–µ—Ç.";
            }

            progress.routeChosen = true;
            progress.routeResult = routeName;
            
            alert(`‚úÖ –†–ï–®–ï–ù–ò–ï –ü–†–ò–ù–Ø–¢–û. ${resultMessage}`);
            
            showRound(4);
        }

        // --- –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –ú–û–î–ï–†–ê–¢–û–†–ê: –í–´–î–ê–ß–ê –†–ï–°–£–†–°–ê (–û–±—Å—É–∂–¥–µ–Ω–∏–µ/–†–∏—Å—É–Ω–æ–∫) ---
        function requestResource(dependency, roundNum) {
            const newResource = prompt(`–ú–û–î–ï–†–ê–¢–û–†: –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ä–µ—Å—É—Ä—Å "${dependency}", –Ω–∞—Ä–∏—Å—É–π—Ç–µ –µ–≥–æ –∏–ª–∏ –¥–æ–≥–æ–≤–æ—Ä–∏—Ç–µ—Å—å. –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤–≤–µ–¥–∏—Ç–µ —Ç–æ—á–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, '–ü—Ä–æ–≤–æ–¥–∞'), –∫–æ—Ç–æ—Ä—ã–π –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ:`);
            
            if (newResource) {
                teamProgress[currentTeam].resources.push(`‚≠ê –û–±—Å—É–∂–¥–µ–Ω–∏–µ: ${newResource}`);
                alert(`‚úÖ –†–µ—Å—É—Ä—Å "${newResource}" –ø–æ–ª—É—á–µ–Ω! –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å.`);
                showRound(roundNum);
            } else {
                alert('–†–µ—Å—É—Ä—Å –Ω–µ –ø–æ–ª—É—á–µ–Ω.');
            }
        }

        // --- –§–£–ù–ö–¶–ò–Ø: –ü–ï–†–ï–î–ê–ß–ê –†–ï–°–£–†–°–ê –ú–ï–ñ–î–£ –ö–û–ú–ê–ù–î–ê–ú–ò ---
        function transferResource() {
            const progress = teamProgress[currentTeam];
            const allResources = [...progress.resources, ...progress.crafted];
            
            if (allResources.length === 0) {
                alert("–£ –≤–∞—à–µ–π –≥—Ä—É–ø–ø—ã –Ω–µ—Ç —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏!");
                return;
            }

            const resourcesList = allResources.map((res, index) => `${index + 1}. ${res}`).join('\n');
            
            const resourceIndexStr = prompt(`--- –ü–ï–†–ï–î–ê–ß–ê –†–ï–°–£–†–°–ê –û–¢ –ì–†–£–ü–ü–´ ${currentTeam} ---\n\n–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä —Ä–µ—Å—É—Ä—Å–∞, –∫–æ—Ç–æ—Ä—ã–π —Ö–æ—Ç–∏—Ç–µ –ø–µ—Ä–µ–¥–∞—Ç—å:\n${resourcesList}\n\n(–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –∏–ª–∏ –æ—Ç–º–µ–Ω–∏—Ç–µ)`);
            
            if (!resourceIndexStr) return;

            const resourceIndex = parseInt(resourceIndexStr) - 1;
            
            if (resourceIndex < 0 || resourceIndex >= allResources.length) {
                alert('–ù–µ–≤–µ—Ä–Ω—ã–π –Ω–æ–º–µ—Ä —Ä–µ—Å—É—Ä—Å–∞!');
                return;
            }

            const resourceToTransfer = allResources[resourceIndex];

            const recipientGroup = prompt(`–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –≥—Ä—É–ø–ø—ã-–ø–æ–ª—É—á–∞—Ç–µ–ª—è (1, 2 –∏–ª–∏ 3):`);

            if (!['1', '2', '3'].includes(recipientGroup)) {
                alert('–ù–µ–≤–µ—Ä–Ω—ã–π –Ω–æ–º–µ—Ä –≥—Ä—É–ø–ø—ã-–ø–æ–ª—É—á–∞—Ç–µ–ª—è (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 1, 2 –∏–ª–∏ 3).');
                return;
            }

            const recipientTeamId = `Group ${recipientGroup}`;
            
            let isCraftedTransfer = false;
            
            // 1. –£–¥–∞–ª—è–µ–º —Ä–µ—Å—É—Ä—Å —É —Ç–µ–∫—É—â–µ–π –∫–æ–º–∞–Ω–¥—ã
            const resIndex = progress.resources.indexOf(resourceToTransfer);
            const craftIndex = progress.crafted.indexOf(resourceToTransfer);

            if (resIndex > -1) {
                progress.resources.splice(resIndex, 1);
            } else if (craftIndex > -1) {
                progress.crafted.splice(craftIndex, 1);
                isCraftedTransfer = true;
            } else {
                alert('–û—à–∏–±–∫–∞: –†–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ.');
                return;
            }
            
            // 2. –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ—Å—É—Ä—Å –∫–æ–º–∞–Ω–¥–µ-–ø–æ–ª—É—á–∞—Ç–µ–ª—é
            const transferredResource = `ü§ù –ü–µ—Ä–µ–¥–∞–Ω–æ: ${resourceToTransfer}`;
            
            if (isCraftedTransfer) {
                // –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç, –¥–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–æ–∫ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö
                 teamProgress[recipientTeamId].crafted.push(transferredResource);
            } else {
                // –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–µ–º –±–∞–∑–æ–≤—ã–π –ø—Ä–µ–¥–º–µ—Ç, –¥–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–æ–∫ –±–∞–∑–æ–≤—ã—Ö
                teamProgress[recipientTeamId].resources.push(transferredResource);
            }
            
            alert(`‚úÖ –£–°–ü–ï–•: –†–µ—Å—É—Ä—Å "${resourceToTransfer}" –ø–µ—Ä–µ–¥–∞–Ω –ì–†–£–ü–ü–ï ${recipientGroup} (${recipientTeamId}).`);

            showRound(currentRound);
        }


        // –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –ü–ï–†–ï–•–û–î–ê –ù–ê –°–õ–ï–î–£–Æ–©–ò–ô –†–ê–£–ù–î
        function nextRound() {
            if (currentRound < 5) {
                showRound(currentRound + 1);
            }
        }
    </script>
</body>
</html>
