<!DOCTYPE html>
<html lang="ru">
<head>
ย ย <meta charset="UTF-8">
ย ย <meta name="viewport" content="width=device-width, initial-scale=1.0">
ย ย <title>ะะะะขะะะะ: ะญะะกะะะะะฆะะฏ ะะะะก | ะะะะขะะะะ ะะฃะะะะ</title>
ย ย 
ย ย ย ย <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
ย ย 
ย ย ย ย <link rel="stylesheet" href="style.css">
ย ย 
</head>
<body>

ย ย <div class="container">
ย ย ย ย 
ย ย ย ย ย ย ย ย <h1>ะะะะกะะะะกะะะ ะขะะะะะะะ: ะะะะขะะะะ "ะะะฌะคะ"</h1>
ย ย ย ย 
ย ย ย ย ย ย ย ย <h2>๐จ ะะะะขะะะะ: ะะะะฃะกะ (ะะะะขะะงะะกะะะ ะกะขะะขะฃะก)</h2>
ย ย ย ย <div class="intro" id="preamble-story">
ย ย ย ย ย ย <p>
ย ย ย ย ย ย ย ย **[ะะะะะะะงะ ะะะะะซะฅ]** ะะฐั ัะฟััะบะฐะตะผัะน ะฐะฟะฟะฐัะฐั, *ยซะะตัะผะตั Vยป*, ัะพะฒะตััะธะป ะถะตััะบัั ะฟะพัะฐะดะบั ะฒ ัะตะณะธะพะฝะต ะญะปะธะทะธัะผ ะะปะฐะฝะธัะธั. ะะพะฒัะตะถะดะตะฝะธั ะบัะธัะธัะตัะบะธะต: ะพัะฝะพะฒะฝะพะน ัะตะฐะบัะพั ะฟะธัะฐะฝะธั ะฒััะตะป ะธะท ัััะพั, ัะธััะตะผั ัะฒัะทะธ ัะฐะฑะพัะฐัั ั ะฟะตัะตะฑะพัะผะธ. ะั ะธะทะพะปะธัะพะฒะฐะฝั, ะฐ ะทะฐะฟะฐัั ะฒะพะทะดััะฐ ะธ ะฒะพะดั ัะฐัััะธัะฐะฝั ะฒัะตะณะพ ะฝะฐ ะฝะตัะบะพะปัะบะพ ะผะฐััะธะฐะฝัะบะธั ัััะพะบ. 
ย ย ย ย ย ย </p>
ย ย ย ย ย ย <p>
ย ย ย ย ย ย ย ย **[ะะกะะะะะะฏ ะฆะะะฌ]** ะะฐัะฐ ะผะธััะธั ะธะทะผะตะฝะธะปะฐัั. ะขะตะฟะตัั ััะพ ะฝะต ะธััะปะตะดะพะฒะฐะฝะธะต, ะฐ **ะะซะะะะะะะ**. ะะฐะผ ะฝะตะพะฑัะพะดะธะผะพ ะฝะตะผะตะดะปะตะฝะฝะพ ะทะฐะฟัััะธัั ะฟัะพัะพะบะพะป ัะบัััะตะฝะฝะพะน ะดะพะฑััะธ ัะตััััะพะฒ, ะฒะพัััะฐะฝะพะฒะธัั ัะฒัะทั ะธ, ัะฐะผะพะต ะณะปะฐะฒะฝะพะต, ะพะฑะตัะฟะตัะธัั ะฟะพััะพัะฝะฝัะน ะฟัะธัะพะบ ะถะธะทะฝะตะฝะฝะพ ะฒะฐะถะฝัั ะบะพะผะฟะพะฝะตะฝัะพะฒ: **ะญะฝะตัะณะธะธ (๐), ะะพะดั (๐ง) ะธ ะะพะทะดััะฐ (๐จ)**. ะะพะผะฐะฝะดะธั, ะฒั ะฟะพะปััะธะปะธ ะบะพะฝััะพะปั ะฝะฐะด ะฑะพััะพะฒัะผ ัะตัะผะธะฝะฐะปะพะผ. ะะฐะถะดัะน ัะฐัะฝะด โ ััะพ ัััะบะธ. **ะััะฐะฒะฐะนัะตัั ะฒ ะถะธะฒัั.**
ย ย ย ย ย ย </p>
ย ย ย ย </div>
ย ย ย ย 
ย ย ย ย ---

ย ย ย ย ย ย ย ย <div class="intro">
ย ย ย ย ย ย <p><strong>[ะกะะกะขะะะ]</strong> ะกัะฐััั: <strong>ะะะะะะ</strong> | ะะฐัะฐ: <span id="current-date">20.11.2077</span> | ะัะตะผั ะะฐััะฐ (UTC+1): <span id="current-time">09:35:00</span></p>
ย ย ย ย ย ย <p><strong>[ะะะกะกะะฏ]</strong> ะฆะตะปั: ะะพะฟะพะปะฝะตะฝะธะต ะทะฐะฟะฐัะพะฒ ะธ ะฐะฝะฐะปะธะท ััะตะดั. ะะพะผะฐะฝะดะธั: <strong>ะะผั ะะตะดััะตะณะพ</strong></p>
ย ย ย ย </div>
ย ย ย ย 
ย ย ย ย ---

ย ย ย ย ย ย ย ย <h2>๐ ะกะขะะขะฃะก ะกะะกะขะะะซ ะ ะะะะะะขะะะฌ</h2>
ย ย ย ย <div class="status-panel">
ย ย ย ย ย ย 
ย ย ย ย ย ย <div class="info-block">
ย ย ย ย ย ย ย ย <h3>ะขะะะฃะฉะะ ะะะกะฃะะกะซ</h3>
                ย ย ย ย ย ย ย ย <p>โค๏ธ ะะดะพัะพะฒัะต: <span id="resource-health">100</span> (ะตะด.)</p>
ย ย ย ย ย ย ย ย <p>๐ ะญะฝะตัะณะธั: <span id="resource-power">1000</span> (ะตะด.)</p>
ย ย ย ย ย ย ย ย <p>๐ง ะะพะดะฐ (HโO): <span id="resource-water">50</span> (ะป)</p>
ย ย ย ย ย ย ย ย <p>๐จ ะะพะทะดัั (Oโ): <span id="resource-air">50</span> (ะผยณ)</p>
ย ย ย ย ย ย </div>

ย ย ย ย ย ย <div class="info-block">
ย ย ย ย ย ย ย ย <h3>ะะะะะะขะะะฌ (ะฃ1, ะฃ2, ะฃ3)</h3>
ย ย ย ย ย ย ย ย <ul id="inventory-list" class="inventory-list">
ย ย ย ย ย ย ย ย ย ย <li class="inventory-item">ะะตั ัะตััััะพะฒ</li>
ย ย ย ย ย ย ย ย </ul>
ย ย ย ย ย ย </div>

ย ย ย ย </div>
ย ย ย ย 
ย ย ย ย ---

ย ย ย ย ย ย ย ย <h2>๐ฏ ะะะฃะะ <span id="round-number">1</span>: ะะซะะะ ะะะะกะขะะะฏ</h2>
ย ย ย ย <div class="round-content">

ย ย ย ย ย ย <h3>1. ะะซะะะ ะะะฃะะะซ</h3>
ย ย ย ย ย ย <div class="group-select">
ย ย ย ย ย ย ย ย <button id="select-group-a">ะััะฟะฟะฐ ะ (ะขะตัะฝะพะปะพะณะธั)</button>
ย ย ย ย ย ย ย ย <button id="select-group-b">ะััะฟะฟะฐ ะ (ะะธะพะปะพะณะธั)</button>
ย ย ย ย ย ย ย ย <button id="select-group-c">ะััะฟะฟะฐ ะ (ะะพะฝััััะบัะธั)</button>
ย ย ย ย ย ย </div>

ย ย ย ย ย ย <h3>2. ะะะะกะขะะะ ะะะฃะะะซ</h3>
ย ย ย ย ย ย <p id="action-prompt">ะัะฑะตัะธัะต ะณััะฟะฟั ะดะปั ะฟัะพะดะพะปะถะตะฝะธั ะฟัะพัะพะบะพะปะฐ...</p>
ย ย ย ย ย ย 
ย ย ย ย ย ย <div id="action-buttons" style="margin-top: 10px;">
ย ย ย ย ย ย ย ย <button class="round-action-button" disabled>ะะซะะะะะะขะฌ ะะะะกะขะะะ</button>
ย ย ย ย ย ย </div>
ย ย ย ย ย ย 
ย ย ย ย ย ย <hr style="border-top: 1px solid #c0392b; margin: 20px 0;">

ย ย ย ย ย ย <h3>3. ะะะะะะจะะะะ ะคะะะซ</h3>
ย ย ย ย ย ย <button id="end-round-button" class="end-round-button" disabled>ะะะะะะจะะขะฌ ะะะฃะะ <span id="next-round-indicator">(2)</span></button>
ย ย ย ย </div>
ย ย ย ย 
ย ย ย ย ---

ย ย ย ย ย ย ย ย <h2>๐ข ะะฃะะะะ ะกะะะซะขะะ</h2>
ย ย ย ย <div id="log-box" class="log-box">
ย ย ย ย ย ย <p><strong>[09:35:25]</strong> ะกะธััะตะผะฝัะน ะัะพัะพะบะพะป ะทะฐะฟััะตะฝ. ะะถะธะดะฐะฝะธะต ะฒะฒะพะดะฐ...</p>
ย ย ย ย </div>

ย ย ย ย ย ย ย ย <div id="mod-panel" class="mod-panel" style="display: none;">
ย ย ย ย ย ย <h2>๐งโ๐ป ะะะะขะะะะ ะกะะฏะะ (ะะะะฃะฉะะ)</h2>
ย ย ย ย ย ย <input type="text" id="mod-input" placeholder="ะะฒะตะดะธัะต ะบะพะผะฐะฝะดั ะธะปะธ ัะพะฑััะธะต...">
ย ย ย ย ย ย <button id="send-mod-message">ะะขะะะะะะขะฌ ะกะะะะฉะะะะ</button>
ย ย ย ย </div>
ย ย ย ย 
ย ย ย ย <div id="game-over-message" class="final-message" style="display: none; margin-top: 30px;">
ย ย ย ย ย ย ะะะกะกะะฏ ะะะะะะจะะะ. ะะะะะะ ะะะะฃะะฌะขะะขะะ.
ย ย ย ย </div>

ย ย </div>

ย ย <script>
ย ย // ====================================================================
ย ย // === ะะะกะฌ ะะะ JAVASCRIPT ะะะฏ ะะะะซ "ะะะะกะะะะกะะะ ะขะะะะะะะ" ===
ย ย // ====================================================================

    // --- 1. ะะะะฆะะะะะะะฆะะฏ ะะะะะะซะฅ ะะะะะะะะะซะฅ ---

    const INITIAL_RESOURCES = {
        POWER: 50,      // ะญะฝะตัะณะธั
        WATER: 50,      // ะะพะดะฐ
        AIR: 50,        // ะะพะทะดัั
        HEALTH: 100,    // ะะดะพัะพะฒัะต ะญะบะธะฟะฐะถะฐ
        FOOD: 5,        // ะะฐััะพัะตะปั (ะะ)
    };
    
    let gameData = {
        round: 1,
        points: 100, // ะกัะฐััะพะฒัะต ะฑะฐะปะปั ะดะปั ะ1
        resources: { ...INITIAL_RESOURCES },
        inventory: {}, 
        activeGroup: null,
        taskCompleted: false, 
        r6Resolved: false, // ะคะปะฐะณ ะดะปั ะ6
    };
    
    // --- 2. ะกะะกะขะะะ ะะะะคะขะะะะ/ะะะกะฃะะกะะ ะ ะฆะะะซ ---
    
    const RESOURCE_PRICES = {
        'ะะ': 22, 'CO2': 16, 'ะะข': 18, 'ะะ': 17, 'ะฅะ': 20, 
        'ะะ': 15, 'N': 19, 'ะะ': 14, 'ะกะ': 23, 'ะคะก': 11,
        'ะะ': 13, 'ะขะข': 25, 'ะะ': 10, 'ะกะ': 24, 'ะะ': 21
    };

    const RESOURCE_DATABASE = {
        TECH_ENERGY: {
            name: "ะขะตัะฝะพะปะพะณะธั ะธ ะญะฝะตัะณะธั",
            level1: [ 
                { code: 'ะะ', name: 'ะะตะณะพะปะธั', description: 'ะะฐััะธะฐะฝัะบะธะน ะณััะฝั, ะพัะฝะพะฒะฐ ะดะปั ะธะทะฒะปะตัะตะฝะธั.', level: 1 },
                { code: 'CO2', name: 'ะฃะณะปะตะบะธัะปัะน ะะฐะท', description: 'ะะท ะฐัะผะพััะตัั (ะกะพะฑัะฐะฝะฝัะน ะณะฐะท).', level: 1 },
                { code: 'ะะข', name: 'ะะตัะฐะฝ', description: 'ะกะปะตะดะพะฒัะต ะบะพะปะธัะตััะฒะฐ (ะดะปั ัะฐะบะตัะฝะพะณะพ ัะพะฟะปะธะฒะฐ).', level: 1 },
                { code: 'ะะ', name: 'ะะตะปะตะทะพ', description: 'ะะบัะธะด ะถะตะปะตะทะฐ, ะธะทะฒะปะตะบะฐะตะผัะน ะธะท ะณััะฝัะฐ.', level: 1 },
                { code: 'ะฅะ', name: 'ะฅะปะพั', description: 'ะะท ะผะธะฝะตัะฐะปะพะฒ (ะพัะธััะบะฐ).', level: 1 },
            ],
            level2: [ 
                { code: 'ะะ', name: 'ะัะตะผะฝะธะตะฒัะต ะะปะฐััะธะฝั', description: 'ะะปั ัะปะตะบััะพะฝะธะบะธ ะธ ัะพะปะฝะตัะฝัั ะฑะฐัะฐัะตะน.', level: 2 },
                { code: 'CO', name: 'ะะพะฝะพะพะบัะธะด ะฃะณะปะตัะพะดะฐ', description: 'ะะปััะตะฒะพะน ะบะพะผะฟะพะฝะตะฝั ะดะปั ัะพะฟะปะธะฒะฐ.', level: 2 },
                { code: 'ะะ', name: 'ะัะฐัะตะฝ', description: 'ะกะฒะตััะปะตะณะบะธะต ะธ ะฟัะพัะฝัะต ะฝะฐะฝะพัััะฑะบะธ.', level: 2 },
                { code: 'ะคะก', name: 'ะคะตััะพัะฟะปะฐะฒ', description: 'ะกะฟะปะฐะฒ ะดะปั ัะปะพะถะฝัั ะผะตัะฐะฝะธัะตัะบะธั ัะฐััะตะน.', level: 2 },
                { code: 'ะญะ', name: 'ะญะปะตะบััะพะปะธั', description: 'ะะปั ะฟัะพะธะทะฒะพะดััะฒะฐ ะฒััะพะบะพัััะตะบัะธะฒะฝัั ะฑะฐัะฐัะตะน.', level: 2 },
            ],
            level3: [ 
                { code: 'ะกะค', name: 'ะกะพะปะฝะตัะฝะฐั ะคะตัะผะฐ', description: 'ะฃะฒะตะปะธัะธะฒะฐะตั ะฒััะฐะฑะพัะบั ะญะปะตะบััะธัะตััะฒะฐ (ะญ) ะฝะฐ +1/ัะพะด.', bonus: { type: 'POWER_BONUS', value: 1 }, level: 3 },
                { code: 'ะะะฃ', name: 'ะะฝัะตะฝะฝะฐ ะััะพะบะพะณะพ ะฃัะธะปะตะฝะธั', description: 'ะะพััะพัะฝะฝัะน ะะพะฝัั ะบ ะะง ะฟัะธ ะฟะพะธัะบะต ัะฝะฐััะถะตะฝะธั.', level: 3 },
                { code: 'ะกะข', name: 'ะกะธะฝัะตะทะธัะพะฒะฐะฝะฝะพะต ะขะพะฟะปะธะฒะพ', description: 'ะฃัััะฐะฝัะตั ัััะฐั ะญ ะดะปั ะดะฐะปัะฝะธั ะฟะพะตะทะดะพะบ ะฝะฐ ัะพะฒะตัะต.', level: 3 },
                { code: 'ะะก', name: 'ะะตะพะปะพะณะธัะตัะบะธะน ะกะบะฐะฝะตั', description: 'ะจะฐะฝั ะฝะฐะนัะธ ัะตะดะบะธะน ัะตัััั (+1 ะฅะก) ะฒ ัะฐะทะต ะธััะปะตะดะพะฒะฐะฝะธั.', level: 3 },
                { code: 'ะะ', name: 'ะะทะพัะพะฟะฝัะน ะะตะฝะตัะฐัะพั', description: '+0.5 ะญ ะฟะพััะพัะฝะฝะพะน ัะฝะตัะณะธะธ.', bonus: { type: 'POWER_BONUS', value: 0.5 }, level: 3 },
            ],
        },
        // ... (ะพััะฐะปัะฝัะต ะบะฐัะตะณะพัะธะธ BIO_LIFE ะธ CONSTRUCTION_REPAIR ะดะพะปะถะฝั ะฑััั ะทะดะตัั, ะฟัะพะฟััะตะฝะพ ะดะปั ะบัะฐัะบะพััะธ) ...
        BIO_LIFE: {
            name: "ะะธะพะปะพะณะธั ะธ ะะธะทะฝะตะพะฑะตัะฟะตัะตะฝะธะต",
            level1: [ { code: 'ะะ', name: 'ะะตะด', description: 'ะะตะด', level: 1 }, { code: 'N', name: 'ะะทะพั', description: 'ะะทะพั', level: 1 }, { code: 'ะะ', name: 'ะะฐะปะธะน', description: 'ะะฐะปะธะน', level: 1 }, { code: 'ะกะ', name: 'ะกะพะปะธ', description: 'ะกะพะปะธ', level: 1 }, { code: 'ะคะก', name: 'ะคะพััะพั', description: 'ะคะพััะพั', level: 1 }],
            level2: [ { code: 'H2O', name: 'ะะธะดะบะฐั ะะพะดะฐ', description: 'ะะพะดะฐ', level: 2 }, { code: 'ะะ', name: 'ะะธัะฐัะตะปัะฝัะน ะะฐััะฒะพั', description: 'ะะ', level: 2 }, { code: 'ะะฃ', name: 'ะะพะฝัะตะฝััะฐั ะฃะดะพะฑัะตะฝะธะน', description: 'ะะฃ', level: 2 }, { code: 'ะะ', name: 'ะะตะดะธะบะฐะผะตะฝัั', description: 'ะะ', level: 2 }, { code: 'ะะ', name: 'ะะธัะตะฒะพะน ะะตะปั', description: 'ะะ', level: 2 }],
            level3: [ { code: 'ะะ', name: 'ะะตะดะธัะธะฝัะบะธะน ะะพั', description: 'ะะ', level: 3, bonus: { type: 'HEALTH_BONUS', value: 5 } }, { code: 'ะกะะ', name: 'ะกะธััะตะผะฐ ะะตัะธัะบัะปััะธะธ ะะพะดั', description: 'ะกะะ', level: 3 }, { code: 'ะะ', name: 'ะะธะพ-ะะตะณะตะฝะตัะฐัะพั (ะโ)', description: 'ะะ', level: 3 }, { code: 'ะะกะะ', name: 'ะะตะฝะตัะธัะตัะบะธะน ะกะตะบะฒะตะฝัะพั', description: 'ะะกะะ', level: 3 }, { code: 'ะะ', name: 'ะะฒัะพะผะฐัะธะทะธัะพะฒะฐะฝะฝัะน ะะณะพัะพะด', description: 'ะะ', level: 3 }],
        },
        CONSTRUCTION_REPAIR: {
            name: "ะะพะฝััััะบัะธั ะธ ะะตะผะพะฝั",
            level1: [ { code: 'ะะ', name: 'ะะปัะผะธะฝะธะน', description: 'ะะปัะผะธะฝะธะน', level: 1 }, { code: 'ะขะข', name: 'ะขะธัะฐะฝ', description: 'ะขะธัะฐะฝ', level: 1 }, { code: 'ะะ', name: 'ะะฐะณััะทะฝะตะฝะฝัะต ะััะพะดั', description: 'ะััะพะดั', level: 1 }, { code: 'ะกะ', name: 'ะกัะตะบะปะพะฒะพะปะพะบะฝะพ', description: 'ะกัะตะบะปะพะฒะพะปะพะบะฝะพ', level: 1 }, { code: 'ะะ', name: 'ะะธะบะตะปั', description: 'ะะธะบะตะปั', level: 1 }],
            level2: [ { code: 'ะะก', name: 'ะะตะณะบะธะน ะกะฟะปะฐะฒ', description: 'ะกะฟะปะฐะฒ', level: 2 }, { code: 'ะะก', name: 'ะะฐะบะฐะปะตะฝะฝัะน ะกะฟะปะฐะฒ', description: 'ะกะฟะปะฐะฒ', level: 2 }, { code: 'ะะ', name: 'ะะพัััะฐะฝะพะฒะปะตะฝะฝัะต ะะพะผะฟะพะฝะตะฝัั', description: 'ะะพะผะฟะพะฝะตะฝัั', level: 2 }, { code: 'ะฃะ', name: 'ะฃะฟัะพัะฝะตะฝะฝัะน ะะพะปะธะผะตั', description: 'ะะพะปะธะผะตั', level: 2 }, { code: 'ะะ', name: 'ะะฝะดัะบัะธะพะฝะฝะฐั ะะฐัััะบะฐ', description: 'ะะฐัััะบะฐ', level: 2 }],
            level3: [ { code: 'ะะกะ', name: 'ะะฒัะพะผะฐัะธัะตัะบะฐั ะกะธััะตะผะฐ ะะตัะผะตัะธะทะฐัะธะธ', description: 'ะะกะ', level: 3 }, { code: 'ะะญ', name: 'ะะฐะดะธะฐัะธะพะฝะฝัะน ะญะบัะฐะฝ', description: 'ะะญ', level: 3 }, { code: 'ะะะ', name: 'ะะฒะฐัะธะนะฝัะน ะะปะพะบ ะะธัะฐะฝะธั', description: 'ะะะ', level: 3 }, { code: 'ะะ', name: 'ะะตะฒะปะฐัะพะฒะฐั ะะฑะพะปะพัะบะฐ', description: 'ะะ', level: 3 }, { code: 'ะกะก', name: 'ะกะฐะผะพะฒะพัััะฐะฝะฐะฒะปะธะฒะฐััะธะนัั ะกะบะฐัะฐะฝะดั', description: 'ะกะก', level: 3 }],
        },
    };

    const RESOURCE_LOOKUP = {};
    Object.values(RESOURCE_DATABASE).forEach(category => {
        Object.keys(category).filter(key => key.startsWith('level')).forEach(levelKey => {
            category[levelKey].forEach(resource => {
                RESOURCE_LOOKUP[resource.code] = resource;
            });
        });
    });

    const CRAFTING_RECIPES_R3 = {
        'ะะ': [{ code: 'ะะ', amount: 2 }], 'H2O': [{ code: 'ะะ', amount: 2 }], 'ะะก': [{ code: 'ะะ', amount: 2 }],
        'ะคะก': [{ code: 'ะะ', amount: 2 }], 'ะะ': [{ code: 'N', amount: 2 }], 'ะะก': [{ code: 'ะขะข', amount: 2 }],
    };

    const CRAFTING_RECIPES_R4 = {
        'ะกะค': [{ code: 'ะะ', amount: 2 }], 'ะะ': [{ code: 'H2O', amount: 2 }], 'ะะกะ': [{ code: 'ะะก', amount: 2 }],
        'ะะ': [{ code: 'ะคะก', amount: 2 }], 'ะกะะ': [{ code: 'ะะ', amount: 2 }], 'ะะญ': [{ code: 'ะะก', amount: 2 }],
    };
    
    // ะะฐะดะฐะฝะธั ะดะปั ะะฐัะฝะดะฐ 1 (ัะพะปัะบะพ ะฃ1)
    const ROUND_1_TASKS = [
        { group: 'TECH_ENERGY', question: "ะะฐะบะพะฒะฐ ะพัะฝะพะฒะฝะฐั ััะฝะบัะธั ะณะตะพะปะพะณะธัะตัะบะพะณะพ ัะบะฐะฝะตัะฐ (ะะก)?", answer: "ะฟะพะธัะบ ัะตะดะบะธั ัะตััััะพะฒ", reward: { code: 'ะะ', amount: 1 }, points: 17 },
        { group: 'BIO_LIFE', question: "ะะฐะทะพะฒะธัะต ะพัะฝะพะฒะฝัั ัะพัะผั ะฒะพะดั, ะบะพัะพััั ะดะพะฑัะฒะฐัั ะฝะฐ ะะฐััะต.", answer: "ะปะตะด", reward: { code: 'ะะ', amount: 1 }, points: 15 },
        { group: 'CONSTRUCTION_REPAIR', question: "ะะฐะบะพะน ัะตัััั ะธัะฟะพะปัะทัะตััั ะดะปั ะธะทะพะปััะธะธ ะธ ะธะผะตะตั ะบะพะด 'ะกะ'?", answer: "ััะตะบะปะพะฒะพะปะพะบะฝะพ", reward: { code: 'ะกะ', amount: 1 }, points: 24 },
    ];
    
    // ะะฐะดะฐะฝะธั ะดะปั ะะฐัะฝะดะฐ 2 (ะฃ1 ัะตัะตะท ะทะฐะดะฐะฝะธะต)
    const ROUND_2_TASKS = {
        'A': { question: "ะะปั ัะตะณะพ ะฝัะถะตะฝ ะะทะพัะพะฟะฝัะน ะะตะฝะตัะฐัะพั (ะะ)?", answer: "ะฟะพััะพัะฝะฝะฐั ัะฝะตัะณะธั", reward: { code: 'CO2', amount: 1 }, penalty: { type: 'POWER', value: 3 } },
        'B': { question: "ะะฐะบะธะต ััะธ ะพัะฝะพะฒะฝัั ัะปะตะผะตะฝัะฐ ะฝะตะพะฑัะพะดะธะผั ะดะปั ัะดะพะฑัะตะฝะธะน (ะบัะพะผะต ะฒะพะดั)?", answer: "ะฐะทะพั ะบะฐะปะธะน ัะพััะพั", reward: { code: 'N', amount: 1 }, penalty: { type: 'WATER', value: 3 } },
        'C': { question: "ะะฐะบะพะน ะผะตัะฐะปะป ะธัะฟะพะปัะทัะตััั ะดะปั ัะฒะตััะฟัะพัะฝัั ะบะพะฝััััะบัะธะน ะธ ะธะผะตะตั ะบะพะด 'ะขะข'?", answer: "ัะธัะฐะฝ", reward: { code: 'ะขะข', amount: 1 }, penalty: { type: 'HEALTH', value: 5 } }
    };
    
    // ะะฐัะฐะผะตััั ะดะปั ะะฐัะฝะดะฐ 5 (ะะฟะพะบะฐะปะธะฟัะธั)
    const APOCALYPSE_PENALTIES = [
        { type: 'WATER', value: 15, msg: 'ะัะธัะธัะตัะบะฐั ะฟะพัะตัั ะฒะพะดั ะธะท-ะทะฐ ะฟัะพะฑะพะธะฝั ะฒ ัััะฑะต.' },
        { type: 'AIR', value: 10, msg: 'ะะฝะฐัะธัะตะปัะฝะฐั ััะตัะบะฐ ะฒะพะทะดััะฐ ะฒ ะถะธะปะพะผ ะพััะตะบะต.' },
        { type: 'HEALTH', value: 20, msg: 'ะกะธะปัะฝัะต ััะฐะฒะผั ัะบะธะฟะฐะถะฐ ะพั ะฟะฐะดะตะฝะธั ะพะฑะพััะดะพะฒะฐะฝะธั.' }
    ];
    const CRISIS_DATABASE = {
        'A': { name: "ะญะะะะะะขะะงะะกะะะ ะจะขะะะ", flaw: "ะฃัะตัะบะฐ ะญะฝะตัะณะธะธ: -10 ะญ ะฒ ะบะพะฝัะต ัะฐัะฝะดะฐ.", resolved: false, solution: { resource: 'ะะ', task: { question: "ะะฐัััะธัะฐะนัะต ัะพะบ (ะฒ ะ), ะตัะปะธ U=20 ะ, R=4 ะะผ.", answer: "5", rewardMsg: "ะะฒะฐัะธะนะฝัะน ะณะตะฝะตัะฐัะพั ะทะฐะฟััะตะฝ.", penalty: { type: 'POWER', value: 5 } } } },
        'B': { name: "ะะะะะะะะงะะกะะะฏ ะฃะะะะะ", flaw: "ะกะฝะฐะฑะถะตะฝะธะต ะะพะดะพะน (HโO) ะธ ะะธัะตะน (FOOD) ะฟัะตะบัะฐัะตะฝะพ.", resolved: false, solution: { resource: 'ะกะะ', task: { question: "ะะฐะบะพะน ะฟัะพัะตัั ะพะฑะตัะฟะตัะธะฒะฐะตั ัะฐััะตะฝะธัะผ ะฒะพะทะผะพะถะฝะพััั ะฒััะฐะฑะฐััะฒะฐัั ะบะธัะปะพัะพะด?", answer: "ัะพัะพัะธะฝัะตะท", rewardMsg: "ะกะธััะตะผะฐ ัะตัะธัะบัะปััะธะธ ะฟะตัะตะทะฐะฟััะตะฝะฐ.", penalty: { type: 'WATER', value: 5 } } } },
        'C': { name: "ะะะะขะะงะะกะะะฏ ะะะะะะะะ", flaw: "50% ัะฐะฝั ะฟะพะปััะธัั -10 ะะดะพัะพะฒัั ั ะบะฐะถะดัะผ ะดะตะนััะฒะธะตะผ.", resolved: false, solution: { resource: 'ะะกะ', task: { question: "ะะฐะบะพะต ะพัะฝะพะฒะฝะพะต ะฟัะตะธะผััะตััะฒะพ ะดะฐะตั ัะฟะปะฐะฒ ะขะธัะฐะฝะฐ (ะขะข) ะดะปั ะบะพัะฟััะฐ?", answer: "ัะฒะตััะฟัะพัะฝะพััั", rewardMsg: "ะัะพะฑะพะธะฝะฐ ะฒัะตะผะตะฝะฝะพ ััััะฐะฝะตะฝะฐ.", penalty: { type: 'HEALTH', value: 10 } } } }
    };

    // --- 3. ะะกะะะะะซะ ะคะฃะะะฆะะ ะะะะซ ---
    
    function updateResourceDisplay() {
        document.getElementById('resource-power').textContent = gameData.resources.POWER;
        document.getElementById('resource-water').textContent = gameData.resources.WATER;
        document.getElementById('resource-air').textContent = gameData.resources.AIR;
        document.getElementById('resource-health').textContent = gameData.resources.HEALTH;
        const pointsEl = document.getElementById('resource-points');
        if(pointsEl) pointsEl.textContent = gameData.points;

        const inventoryList = document.getElementById('inventory-list');
        inventoryList.innerHTML = '';
        
        let hasInventory = false;
        for (const code in gameData.inventory) {
            const count = gameData.inventory[code];
            if (count > 0) {
                hasInventory = true;
                const res = RESOURCE_LOOKUP[code];
                const item = document.createElement('li');
                item.className = 'inventory-item';
                item.textContent = `${res.name} (${res.code} - ะฃ${res.level}): ${count}`;
                inventoryList.appendChild(item);
            }
        }
        if (!hasInventory) {
             inventoryList.innerHTML = '<li class="inventory-item">ะะตั ัะตััััะพะฒ</li>';
        }
    }

    function logEvent(message, isError = false) {
        const logBox = document.getElementById('log-box');
        const p = document.createElement('p');
        p.innerHTML = `[${new Date().toLocaleTimeString('ru-RU', { hour12: false })}] ${message}`;
        if (isError) {
            p.classList.add('error');
        }
        logBox.prepend(p); 
        if (logBox.children.length > 20) {
            logBox.removeChild(logBox.lastChild);
        }
    }

    // --- ะะะฃะะ 1 ะะะะะะ (ะะะะฃะะะ) ---
    function renderRound1Actions() { /* ... (ะปะพะณะธะบะฐ ะ1) ... */ }
    function buyResource(code, price) { /* ... (ะปะพะณะธะบะฐ ะ1) ... */ }
    function startRound1TaskPhase() { /* ... (ะปะพะณะธะบะฐ ะ1) ... */ }
    function submitRound1Task(groupCode) { /* ... (ะปะพะณะธะบะฐ ะ1) ... */ }
    function initRound1() {
        document.getElementById('round-number').textContent = gameData.round;
        document.getElementById('next-round-indicator').textContent = `(${gameData.round + 1})`;
        document.getElementById('select-group-a').disabled = true;
        document.getElementById('select-group-b').disabled = true;
        document.getElementById('select-group-c').disabled = true;
        const statusPanel = document.querySelector('.info-block');
        const pointsP = document.createElement('p');
        pointsP.innerHTML = `๐ต ะะฐะปะปั ะฟะพะบัะฟะบะธ: <span id="resource-points">${gameData.points}</span> (ะตะด.)`;
        statusPanel.prepend(pointsP);
        logEvent('ะกะะกะขะะะ: ะะฐะฟััะบ ะัะพัะพะบะพะปะฐ ะะฐัะฝะดะฐ 1. ะะฐัะฝะธัะต ะทะฐะบัะฟะบั ัะตััััะพะฒ ะฃัะพะฒะฝั 1 (100 ะะฐะปะปะพะฒ).');
        renderRound1Actions();
        updateResourceDisplay();
        document.getElementById('end-round-button').onclick = nextRound;
        document.getElementById('end-round-button').disabled = true;
    }
    
    // --- ะะะฃะะ 2 ะะะะะะ (ะะะะะ ะฃ1) ---
    function initRound2() {
        document.getElementById('action-prompt').textContent = 'ะัะฑะตัะธัะต ะณััะฟะฟั (A, B, ะธะปะธ C) ะดะปั ะฒัะฟะพะปะฝะตะฝะธั ะทะฐะดะฐะฝะธั ะธ ะดะพะฑััะธ 1 ะตะด. ัะตััััะฐ ะฃ1.';
        document.getElementById('select-group-a').onclick = () => selectGroup('A');
        document.getElementById('select-group-b').onclick = () => selectGroup('B');
        document.getElementById('select-group-c').onclick = () => selectGroup('C');
        document.getElementById('end-round-button').disabled = false;
        document.getElementById('end-round-button').textContent = `ะะะะะะจะะขะฌ ะะะฃะะ ${gameData.round} (ะะะะะะขะ ะ 3)`;
        renderRound2Actions();
        logEvent('ะกะะกะขะะะ: ะะบัะธะฒะธัะพะฒะฐะฝ ะะฐัะฝะด 2. ะะพัััะฟะฝะฐ ัะฐะทะฐ ะดะพะฑััะธ ัะตััััะพะฒ ะฃ1 ัะตัะตะท ะฒัะฟะพะปะฝะตะฝะธะต ะทะฐะดะฐะฝะธะน.');
    }
    function renderRound2Actions() { /* ... (ะปะพะณะธะบะฐ ะ2) ... */ }
    function submitRound2Task() { /* ... (ะปะพะณะธะบะฐ ะ2) ... */ }

    // --- ะะะฃะะ 3 ะะะะะะ (ะะะะคะขะะะ ะฃ2) ---
    function initRound3() {
        document.getElementById('action-prompt').textContent = 'ะะะฃะะ 3: ะะะะคะขะะะ ะฃะะะะะฏ 2. ะัะฑะตัะธัะต ัะตัััั ะฃ2, ะบะพัะพััะน ัะพัะธัะต ะฟัะพะธะทะฒะตััะธ.';
        document.getElementById('select-group-a').onclick = () => selectGroup('A');
        document.getElementById('select-group-b').onclick = () => selectGroup('B');
        document.getElementById('select-group-c').onclick = () => selectGroup('C');
        document.getElementById('end-round-button').disabled = false;
        document.getElementById('end-round-button').textContent = `ะะะะะะจะะขะฌ ะะะฃะะ ${gameData.round} (ะะะะะะขะ ะ 4)`;
        renderRound3Actions();
        logEvent('ะกะะกะขะะะ: ะะบัะธะฒะธัะพะฒะฐะฝ ะะฐัะฝะด 3. ะัะฐััะธะฝะณ ัะตััััะพะฒ ะฃัะพะฒะฝั 2.');
    }
    function renderRound3Actions() { /* ... (ะปะพะณะธะบะฐ ะ3) ... */ }
    function tryCrafting(outputCode, recipe) { /* ... (ะปะพะณะธะบะฐ ะ3) ... */ }

    // --- ะะะฃะะ 4 ะะะะะะ (ะะะะคะขะะะ ะฃ3) ---
    function initRound4() {
        document.getElementById('action-prompt').textContent = 'ะะะฃะะ 4: ะะะะคะขะะะ ะฃะะะะะฏ 3 (ะะะขะะะซะ ะกะะกะขะะะซ). ะัะฑะตัะธัะต, ะบะฐะบัั ะบัะธัะธัะตัะบัั ัะธััะตะผั ัะพะทะดะฐัั.';
        document.getElementById('end-round-button').disabled = false;
        document.getElementById('end-round-button').textContent = `ะะะะะะจะะขะฌ ะะะฃะะ ${gameData.round} (ะะะะะะขะ ะ ะะะะะะะะะกะะกะฃ)`;
        renderRound4Actions();
        logEvent('ะกะะกะขะะะ: ะะบัะธะฒะธัะพะฒะฐะฝ ะะฐัะฝะด 4. ะัะฐััะธะฝะณ ะณะพัะพะฒัั ัะธััะตะผ ะฃัะพะฒะฝั 3.');
    }
    function renderRound4Actions() { /* ... (ะปะพะณะธะบะฐ ะ4) ... */ }

    // --- ะะะฃะะ 5 ะะะะะะ (ะะะะะะะะะกะะก) ---
    function initRound5() {
        APOCALYPSE_PENALTIES.forEach(p => {
            gameData.resources[p.type] -= p.value;
            logEvent(`๐จ ะะะะะะกะะซะ ะฃะะะ: -${p.value} ${p.type.toUpperCase()}. ${p.msg}`, true);
        });
        if (gameData.resources.WATER <= 0 || gameData.resources.AIR <= 0 || gameData.resources.HEALTH <= 0) {
            document.getElementById('game-over-message').textContent = 'ะะะะขะะงะะกะะะ ะะขะะะ. ะะะกะกะะฏ ะะะะะะะะะ. ะญะะะะะ ะะะขะะะฏะ.';
            document.getElementById('game-over-message').style.display = 'block';
            document.getElementById('end-round-button').disabled = true;
            return;
        }
        document.getElementById('action-prompt').textContent = 'ะะะฃะะ 5: ะขะะะะะะ ะะะะะะก! ะะฐะถะดะฐั ะณััะฟะฟะฐ ะดะพะปะถะฝะฐ ัะตัะธัั ัะฒะพั ะฟัะพะฑะปะตะผั.';
        document.getElementById('select-group-a').onclick = () => selectGroup('A');
        document.getElementById('select-group-b').onclick = () => selectGroup('B');
        document.getElementById('select-group-c').onclick = () => selectGroup('C');
        document.getElementById('end-round-button').disabled = false;
        document.getElementById('end-round-button').textContent = `ะะะะะะจะะขะฌ ะะะฃะะ ${gameData.round} (ะะะะะะขะ ะ 6)`;
        renderRound5Actions();
        logEvent('ะกะะกะขะะะ: ะะฐะฟััะตะฝ ะะฐัะฝะด 5. ะขะะะะะะ ะะะะะะก ะะะขะะะะ. ะกัะพัะฝะพ ััััะฐะฝะธัะต ัะณัะพะทั!', true);
        updateResourceDisplay();
    }
    function renderRound5Actions() { /* ... (ะปะพะณะธะบะฐ ะ5) ... */ }
    function resolveCrisisResource(groupCode) { /* ... (ะปะพะณะธะบะฐ ะ5) ... */ }
    function resolveCrisisTask(groupCode) { /* ... (ะปะพะณะธะบะฐ ะ5) ... */ }

    // --- ะะะฃะะ 6 ะะะะะะ (ะกะะขะะฃะะะะงะะกะขะะ) ---
    // (ะะพะด ะธะท ัะตะบัะธะธ 1)
    
    // --- ะะะฃะะ 7 ะะะะะะ (ะคะะะะ) ---
    // (ะะพะด ะธะท ัะตะบัะธะธ 1)

    // --- ะะะะะะะฌะะะ ะฃะะะะะะะะะ ---
    
    function selectGroup(group) {
        gameData.activeGroup = group;
        logEvent(`ะััะฟะฟะฐ ${group} ะฒัะฑัะฐะฝะฐ. ะะถะธะดะฐะฝะธะต ะดะตะนััะฒะธั...`);
        if (gameData.round === 2) {
            renderRound2Actions();
        } else if (gameData.round === 3) {
            renderRound3Actions();
        } else if (gameData.round === 4) {
            renderRound4Actions();
        } else if (gameData.round === 5) {
            renderRound5Actions();
        } else if (gameData.round === 6) {
            renderRound6Actions();
        }
    }

    function nextRound() {
        // ะฃัะตั ัะฐััะพะดะฐ ัะตััััะพะฒ
        gameData.resources.WATER -= 5;
        gameData.resources.AIR -= 5;
        
        // ะัะพะฒะตัะบะฐ ะฝะฐ ะฟะพัะฐะถะตะฝะธะต
        if (gameData.resources.WATER <= 0 || gameData.resources.AIR <= 0 || gameData.resources.HEALTH <= 0) {
            document.getElementById('game-over-message').textContent = 'ะะะกะกะะฏ ะะะะะะะะะ. ะะะะขะะงะะกะะะ ะะขะะะ ะกะะกะขะะ ะะะะะะะะะกะะะงะะะะฏ.';
            document.getElementById('game-over-message').style.display = 'block';
            document.getElementById('end-round-button').disabled = true;
            logEvent('ะะะะขะะงะะกะะะ ะะขะะะ: ะะตััััั ะถะธะทะฝะตะพะฑะตัะฟะตัะตะฝะธั ะธััะตัะฟะฐะฝั. ะะณัะฐ ะพะบะพะฝัะตะฝะฐ.', true);
            return;
        }

        // ะะะะะะะะ ะะะะะะกะ ะ ะะะะฆะ ะะะฃะะะ 5
        if (gameData.round === 5) {
            Object.values(CRISIS_DATABASE).forEach(crisis => {
                if (!crisis.resolved) {
                    logEvent(`โ๏ธ ะะกะขะะะจะะะกะฏ ะะะะะะะะะะะ: ะัะธะทะธั "${crisis.name}" ะฝะต ััััะฐะฝะตะฝ. ะญััะตะบั ะฟัะพะดะพะปะถะฐะตััั!`, true);
                    if (crisis.name === "ะญะะะะะะขะะงะะกะะะ ะจะขะะะ") {
                         gameData.resources.POWER -= 10;
                         logEvent('ะะะะขะะงะะกะะะ ะจะขะะะค: -10 ะญะฝะตัะณะธะธ ะธะท-ะทะฐ ะฝะตัะตัะตะฝะฝะพะณะพ ะจัะพัะผะฐ.', true);
                    }
                    // ะะพะฑะฐะฒะธัั ะดััะณะธะต ัััะฐัั, ะตัะปะธ ะบัะธะทะธัั ะฝะต ัะตัะตะฝั
                }
            });
        }

        gameData.round++;
        logEvent(`--- ะฃะกะะะจะะซะ ะะะะะฅะะ ะ ะะะฃะะะฃ ${gameData.round}! ---`, true);
        document.getElementById('round-number').textContent = gameData.round;
        document.getElementById('next-round-indicator').textContent = `(${gameData.round + 1})`;

        // ะกะฑัะพั ัะพััะพัะฝะธั ัะฐัะฝะดะฐ
        gameData.taskCompleted = false;
        gameData.activeGroup = null;
        gameData.points = 0; 
        
        // ะะฐะฟััะบ ัะพะพัะฒะตัััะฒัััะตะณะพ ัะฐัะฝะดะฐ
        if (gameData.round === 2) {
            initRound2();
        } else if (gameData.round === 3) {
            initRound3();
        } else if (gameData.round === 4) {
            initRound4();
        } else if (gameData.round === 5) {
            initRound5();
        } else if (gameData.round === 6) {
            initRound6();
        } else if (gameData.round === 7) {
            initRound7();
        }
        
        updateResourceDisplay(); 
        document.getElementById('end-round-button').disabled = false; 
    }
    
    function initGame() {
        document.getElementById('end-round-button').onclick = nextRound;
        initRound1(); 
    }

    window.onload = initGame;
    </script>

</body>
</html>
